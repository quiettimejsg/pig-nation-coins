import{a}from"./utils-YxF-Kp8o.js";import{u as e,a as s,j as t}from"./index-rIlpOBuL.js";import{u as n}from"./router-Buckysma.js";import"./vendor-CXUWDbkB.js";function l(){var l;const{t:c}=e(),r=n(),{currentUser:i}=s(),[o,d]=a.useState([]),[m,h]=a.useState({dailyTotal:0,weeklyTotal:0,monthlyTotal:0});return a.useEffect((()=>{if(!i||"merchant"!==i.role)return void r("/");const a=(s.getState().transactions||[]).filter((a=>{var e,s;return(null==(e=a.merchantInfo)?void 0:e.id)===i.id||(null==(s=a.merchantInfo)?void 0:s.name)===i.username}));d(a);const e=new Date((new Date).setHours(0,0,0,0)),t=new Date(e);t.setDate(t.getDate()-7);const n=new Date(e);n.setMonth(n.getMonth()-1);const l=a.filter((a=>new Date(a.timestamp)>=e)),c=a.filter((a=>new Date(a.timestamp)>=t)),o=a.filter((a=>new Date(a.timestamp)>=n));h({dailyTotal:l.reduce(((a,e)=>a+e.amount),0),weeklyTotal:c.reduce(((a,e)=>a+e.amount),0),monthlyTotal:o.reduce(((a,e)=>a+e.amount),0)})}),[i,r]),i?t.jsx("div",{className:"merchant-dashboard-page",children:t.jsxs("div",{className:"content-with-glass",children:[t.jsxs("h1",{children:[c("merchant.welcome",{fallback:"欢迎"}),", ",i.username,"!"]}),t.jsxs("div",{className:"stats-cards",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:c("merchant.daily_sales",{fallback:"今日销售"})}),t.jsxs("p",{className:"stat-value",children:["¥",m.dailyTotal.toFixed(2)]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:c("merchant.weekly_sales",{fallback:"本周销售"})}),t.jsxs("p",{className:"stat-value",children:["¥",m.weeklyTotal.toFixed(2)]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:c("merchant.monthly_sales",{fallback:"本月销售"})}),t.jsxs("p",{className:"stat-value",children:["¥",m.monthlyTotal.toFixed(2)]})]})]}),t.jsxs("div",{className:"merchant-balance",children:[t.jsx("h2",{children:c("merchant.account_balance",{fallback:"账户余额"})}),t.jsxs("p",{className:"balance-amount",children:["¥",null==(l=i.balance)?void 0:l.toFixed(2)]})]}),t.jsxs("div",{className:"section",children:[t.jsx("h2",{children:c("merchant.recent_transactions",{fallback:"最近交易"})}),0===o.length?t.jsx("p",{className:"no-transactions",children:c("merchant.no_transactions",{fallback:"暂无交易记录"})}):t.jsx("ul",{className:"transaction-list",children:o.map(((a,e)=>t.jsxs("li",{className:"transaction-item payment",children:[t.jsxs("div",{className:"transaction-details",children:[t.jsx("span",{className:"transaction-date",children:new Date(a.timestamp).toLocaleDateString()}),t.jsx("span",{className:"transaction-type",children:c("transaction.payment",{fallback:"收款"})})]}),t.jsxs("span",{className:"transaction-amount positive",children:["+ ¥",a.amount.toFixed(2)]})]},a.id||e)))})]})]})}):null}export{l as default};
